---
import '../styles/global.css';
import Navigation from '../components/Navigation.astro';
---

<html lang="fr">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Présentation Objet 3D</title>

    <!-- Police Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            background: #000;
            color: #fff;
            font-family: "Inter", sans-serif;
            overflow-x: hidden;
        }

        .layout {
            display: flex;
            height: 100vh;
            padding: 3rem;
            box-sizing: border-box;
        }

        .left-text {
            width: 40%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 1rem;
            padding-right: 2rem;
        }

        .left-text h1 {
            font-size: 3rem;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .left-text p {
            font-size: 1.2rem;
            line-height: 1.6;
            color: #cccccc;
        }

        #canvas3d {
            width: 60%;
            height: 100%;
        }

        .mockups {
            position: absolute;
            bottom: 0;
            width: 100%;
            display: flex;
            gap: 1rem;
            padding: 1rem 2rem;
            box-sizing: border-box;
            overflow-x: auto;
        }

        .mockups img {
            height: 120px;
            border-radius: 10px;
            object-fit: cover;
            flex-shrink: 0;
        }

        /* Scroll minimaliste */
        .mockups::-webkit-scrollbar {
            height: 6px;
        }
        .mockups::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <Navigation />

    <div class="layout">
        <div class="left-text">
            <h1>Mon Objet 3D</h1>
            <p>
                Voici un objet 3D conçu sur Blender, puis intégré dans une scène Three.js.
                Style minimaliste, mouvement fluide, et rendu propre en temps réel.
            </p>
        </div>

        <canvas id="canvas3d"></canvas>
    </div>

    <!-- Bande de mockups -->
    <div class="mockups">
        <img src="/mockup1.jpg" alt="mockup 1">
        <img src="/mockup2.jpg" alt="mockup 2">
        <img src="/mockup3.jpg" alt="mockup 3">
        <img src="/mockup4.jpg" alt="mockup 4">
    </div>
</body>
</html>

<script>
    import * as THREE from 'three';
    import { gsap } from 'gsap';

    const canvas = document.getElementById('canvas3d');
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x000000);

    const camera = new THREE.PerspectiveCamera(
        75,
        canvas.clientWidth / canvas.clientHeight,
        0.1,
        1000
    );
    camera.position.z = 5;

    const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    renderer.setSize(canvas.clientWidth, canvas.clientHeight);
    renderer.setPixelRatio(window.devicePixelRatio);

    const geometry = new THREE.BoxGeometry(2, 2, 2);
    const materials = [
        new THREE.MeshStandardMaterial({ color: 0xff6b6b }),
        new THREE.MeshStandardMaterial({ color: 0x4ecdc4 }),
        new THREE.MeshStandardMaterial({ color: 0xffe66d }),
        new THREE.MeshStandardMaterial({ color: 0x95e1d3 }),
        new THREE.MeshStandardMaterial({ color: 0xf38181 }),
        new THREE.MeshStandardMaterial({ color: 0xaa96da }),
    ];
    const cube = new THREE.Mesh(geometry, materials);
    scene.add(cube);

    const ambientLight = new THREE.AmbientLight(0xffffff, 1.2);
    scene.add(ambientLight);

    gsap.to(cube.rotation, {
        y: Math.PI * 2,
        duration: 10,
        repeat: -1,
        ease: "none"
    });

    let mouseX = 0;
    let mouseY = 0;
    let targetRotationX = 0;
    let targetRotationY = 0;

    document.addEventListener('mousemove', (e) => {
        mouseX = (e.clientX / window.innerWidth) * 2 - 1;
        mouseY = -(e.clientY / window.innerHeight) * 2 + 1;
        targetRotationX = mouseY * 0.5;
        targetRotationY = mouseX * 0.5;
    });

    function resize() {
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;
        camera.aspect = w / h;
        camera.updateProjectionMatrix();
        renderer.setSize(w, h);
    }
    window.addEventListener("resize", resize);

    function animate() {
        requestAnimationFrame(animate);
        cube.rotation.x += (targetRotationX - cube.rotation.x) * 0.05;
        cube.rotation.z += (targetRotationY - cube.rotation.z) * 0.05;

        const scale = 1 + Math.sin(Date.now() * 0.001) * 0.1;
        cube.scale.set(scale, scale, scale);

        renderer.render(scene, camera);
    }
    animate();
</script>
